[2019-03-18 15:51:15,752] INFO Reading configuration from: /data/bdata/kafka/config/zookeeper.properties (org.apache.zookeeper.server.quorum.QuorumPeerConfig)
[2019-03-18 15:51:15,821] INFO Resolved hostname: bdata3 to address: bdata3/192.168.33.202 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:15,821] INFO Resolved hostname: bdata2 to address: bdata2/192.168.33.201 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:15,821] INFO Resolved hostname: bdata1 to address: bdata1/192.168.33.200 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:15,821] INFO Defaulting to majority quorums (org.apache.zookeeper.server.quorum.QuorumPeerConfig)
[2019-03-18 15:51:16,556] INFO autopurge.snapRetainCount set to 3 (org.apache.zookeeper.server.DatadirCleanupManager)
[2019-03-18 15:51:16,556] INFO autopurge.purgeInterval set to 0 (org.apache.zookeeper.server.DatadirCleanupManager)
[2019-03-18 15:51:16,556] INFO Purge task is not scheduled. (org.apache.zookeeper.server.DatadirCleanupManager)
[2019-03-18 15:51:16,581] INFO Starting quorum peer (org.apache.zookeeper.server.quorum.QuorumPeerMain)
[2019-03-18 15:51:16,606] INFO Using org.apache.zookeeper.server.NIOServerCnxnFactory as server connection factory (org.apache.zookeeper.server.ServerCnxnFactory)
[2019-03-18 15:51:17,775] INFO binding to port 0.0.0.0/0.0.0.0:2181 (org.apache.zookeeper.server.NIOServerCnxnFactory)
[2019-03-18 15:51:18,872] INFO tickTime set to 2000 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:18,872] INFO initLimit set to 5 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:18,872] INFO minSessionTimeout set to -1 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:18,872] INFO maxSessionTimeout set to -1 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:18,879] INFO QuorumPeer communication is not secured! (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:18,879] INFO quorum.cnxn.threads.size set to 20 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:19,707] INFO My election bind port: bdata1/192.168.33.200:3888 (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:19,740] INFO LOOKING (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:19,742] INFO New election. My id =  1, proposed zxid=0xa000003e7 (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:19,743] INFO Notification: 1 (message format version), 1 (n.leader), 0xa000003e7 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0xa (n.peerEpoch) LOOKING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:20,135] INFO Have smaller server identifier, so dropping the connection: (2, 1) (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,136] INFO Received connection request /192.168.33.201:54708 (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,136] INFO Have smaller server identifier, so dropping the connection: (3, 1) (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,138] INFO Have smaller server identifier, so dropping the connection: (2, 1) (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,138] INFO Notification time out: 400 (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:20,543] INFO Have smaller server identifier, so dropping the connection: (2, 1) (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,544] INFO Have smaller server identifier, so dropping the connection: (3, 1) (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,544] INFO Notification time out: 800 (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:20,722] INFO Received connection request /192.168.33.201:54710 (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,874] INFO Received connection request /192.168.33.202:37096 (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,875] INFO Received connection request /192.168.33.201:54712 (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,878] INFO Notification: 1 (message format version), 2 (n.leader), 0x900000018 (n.zxid), 0x1 (n.round), FOLLOWING (n.state), 3 (n.sid), 0xa (n.peerEpoch) LOOKING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:20,879] INFO Notification: 1 (message format version), 2 (n.leader), 0x900000018 (n.zxid), 0x1 (n.round), LEADING (n.state), 2 (n.sid), 0xa (n.peerEpoch) LOOKING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:20,880] INFO FOLLOWING (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:20,883] WARN Interrupted while waiting for message on queue (org.apache.zookeeper.server.quorum.QuorumCnxManager)
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:1094)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$700(QuorumCnxManager.java:74)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:929)
[2019-03-18 15:51:20,922] WARN Send worker leaving thread (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,903] INFO TCP NoDelay set to: true (org.apache.zookeeper.server.quorum.Learner)
[2019-03-18 15:51:20,884] WARN Connection broken for id 3, my id = 1, error =  (org.apache.zookeeper.server.quorum.QuorumCnxManager)
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:1010)
[2019-03-18 15:51:20,924] WARN Interrupting SendWorker (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:20,884] WARN Connection broken for id 2, my id = 1, error =  (org.apache.zookeeper.server.quorum.QuorumCnxManager)
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:1010)
[2019-03-18 15:51:20,924] WARN Interrupting SendWorker (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:21,646] WARN Connection broken for id 2, my id = 1, error =  (org.apache.zookeeper.server.quorum.QuorumCnxManager)
java.net.SocketException: Socket closed
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:171)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:1010)
[2019-03-18 15:51:21,646] WARN Interrupting SendWorker (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:21,664] ERROR Failed to send last message. Shutting down thread. (org.apache.zookeeper.server.quorum.QuorumCnxManager)
java.net.SocketException: Broken pipe (Write failed)
	at java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111)
	at java.net.SocketOutputStream.write(SocketOutputStream.java:155)
	at java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.io.FilterOutputStream.write(FilterOutputStream.java:97)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.send(QuorumCnxManager.java:887)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:913)
[2019-03-18 15:51:21,664] WARN Exception when using channel: for id 3 my id = 1 error = java.net.SocketException: Broken pipe (Write failed) (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:21,665] WARN Send worker leaving thread (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:21,665] INFO Notification: 1 (message format version), 2 (n.leader), 0x900000018 (n.zxid), 0x1 (n.round), LEADING (n.state), 2 (n.sid), 0xa (n.peerEpoch) FOLLOWING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:21,665] WARN Send worker leaving thread (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:21,665] INFO Received connection request /192.168.33.202:37098 (org.apache.zookeeper.server.quorum.QuorumCnxManager)
[2019-03-18 15:51:21,667] INFO Notification: 1 (message format version), 2 (n.leader), 0x900000018 (n.zxid), 0x1 (n.round), FOLLOWING (n.state), 3 (n.sid), 0xa (n.peerEpoch) FOLLOWING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:21,668] INFO Notification: 1 (message format version), 2 (n.leader), 0x900000018 (n.zxid), 0x1 (n.round), LEADING (n.state), 2 (n.sid), 0xa (n.peerEpoch) FOLLOWING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:21,669] INFO Server environment:zookeeper.version=3.4.13-2d71af4dbe22557fda74f9a9b4309b15a7487f03, built on 06/29/2018 00:39 GMT (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Server environment:host.name=bdata1 (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Server environment:java.version=1.8.0_201 (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Server environment:java.vendor=Oracle Corporation (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Server environment:java.home=/usr/local/jdk/jre (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Server environment:java.class.path=.:/usr/local/jdk/lib/dt.jar:/usr/local/jdk/lib/tools.jar:/usr/local/jdk/jre/lib:/data/bdata/kafka/bin/../libs/activation-1.1.1.jar:/data/bdata/kafka/bin/../libs/aopalliance-repackaged-2.5.0-b42.jar:/data/bdata/kafka/bin/../libs/argparse4j-0.7.0.jar:/data/bdata/kafka/bin/../libs/audience-annotations-0.5.0.jar:/data/bdata/kafka/bin/../libs/commons-lang3-3.8.1.jar:/data/bdata/kafka/bin/../libs/connect-api-2.1.1.jar:/data/bdata/kafka/bin/../libs/connect-basic-auth-extension-2.1.1.jar:/data/bdata/kafka/bin/../libs/connect-file-2.1.1.jar:/data/bdata/kafka/bin/../libs/connect-json-2.1.1.jar:/data/bdata/kafka/bin/../libs/connect-runtime-2.1.1.jar:/data/bdata/kafka/bin/../libs/connect-transforms-2.1.1.jar:/data/bdata/kafka/bin/../libs/guava-20.0.jar:/data/bdata/kafka/bin/../libs/hk2-api-2.5.0-b42.jar:/data/bdata/kafka/bin/../libs/hk2-locator-2.5.0-b42.jar:/data/bdata/kafka/bin/../libs/hk2-utils-2.5.0-b42.jar:/data/bdata/kafka/bin/../libs/jackson-annotations-2.9.8.jar:/data/bdata/kafka/bin/../libs/jackson-core-2.9.8.jar:/data/bdata/kafka/bin/../libs/jackson-databind-2.9.8.jar:/data/bdata/kafka/bin/../libs/jackson-jaxrs-base-2.9.8.jar:/data/bdata/kafka/bin/../libs/jackson-jaxrs-json-provider-2.9.8.jar:/data/bdata/kafka/bin/../libs/jackson-module-jaxb-annotations-2.9.8.jar:/data/bdata/kafka/bin/../libs/javassist-3.22.0-CR2.jar:/data/bdata/kafka/bin/../libs/javax.annotation-api-1.2.jar:/data/bdata/kafka/bin/../libs/javax.inject-1.jar:/data/bdata/kafka/bin/../libs/javax.inject-2.5.0-b42.jar:/data/bdata/kafka/bin/../libs/javax.servlet-api-3.1.0.jar:/data/bdata/kafka/bin/../libs/javax.ws.rs-api-2.1.1.jar:/data/bdata/kafka/bin/../libs/javax.ws.rs-api-2.1.jar:/data/bdata/kafka/bin/../libs/jaxb-api-2.3.0.jar:/data/bdata/kafka/bin/../libs/jersey-client-2.27.jar:/data/bdata/kafka/bin/../libs/jersey-common-2.27.jar:/data/bdata/kafka/bin/../libs/jersey-container-servlet-2.27.jar:/data/bdata/kafka/bin/../libs/jersey-container-servlet-core-2.27.jar:/data/bdata/kafka/bin/../libs/jersey-hk2-2.27.jar:/data/bdata/kafka/bin/../libs/jersey-media-jaxb-2.27.jar:/data/bdata/kafka/bin/../libs/jersey-server-2.27.jar:/data/bdata/kafka/bin/../libs/jetty-client-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-continuation-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-http-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-io-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-security-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-server-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-servlet-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-servlets-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jetty-util-9.4.12.v20180830.jar:/data/bdata/kafka/bin/../libs/jopt-simple-5.0.4.jar:/data/bdata/kafka/bin/../libs/kafka_2.12-2.1.1.jar:/data/bdata/kafka/bin/../libs/kafka_2.12-2.1.1-sources.jar:/data/bdata/kafka/bin/../libs/kafka-clients-2.1.1.jar:/data/bdata/kafka/bin/../libs/kafka-log4j-appender-2.1.1.jar:/data/bdata/kafka/bin/../libs/kafka-streams-2.1.1.jar:/data/bdata/kafka/bin/../libs/kafka-streams-examples-2.1.1.jar:/data/bdata/kafka/bin/../libs/kafka-streams-scala_2.12-2.1.1.jar:/data/bdata/kafka/bin/../libs/kafka-streams-test-utils-2.1.1.jar:/data/bdata/kafka/bin/../libs/kafka-tools-2.1.1.jar:/data/bdata/kafka/bin/../libs/log4j-1.2.17.jar:/data/bdata/kafka/bin/../libs/lz4-java-1.5.0.jar:/data/bdata/kafka/bin/../libs/maven-artifact-3.6.0.jar:/data/bdata/kafka/bin/../libs/metrics-core-2.2.0.jar:/data/bdata/kafka/bin/../libs/osgi-resource-locator-1.0.1.jar:/data/bdata/kafka/bin/../libs/plexus-utils-3.1.0.jar:/data/bdata/kafka/bin/../libs/reflections-0.9.11.jar:/data/bdata/kafka/bin/../libs/rocksdbjni-5.14.2.jar:/data/bdata/kafka/bin/../libs/scala-library-2.12.7.jar:/data/bdata/kafka/bin/../libs/scala-logging_2.12-3.9.0.jar:/data/bdata/kafka/bin/../libs/scala-reflect-2.12.7.jar:/data/bdata/kafka/bin/../libs/slf4j-api-1.7.25.jar:/data/bdata/kafka/bin/../libs/slf4j-log4j12-1.7.25.jar:/data/bdata/kafka/bin/../libs/snappy-java-1.1.7.2.jar:/data/bdata/kafka/bin/../libs/validation-api-1.1.0.Final.jar:/data/bdata/kafka/bin/../libs/zkclient-0.11.jar:/data/bdata/kafka/bin/../libs/zookeeper-3.4.13.jar:/data/bdata/kafka/bin/../libs/zstd-jni-1.3.7-1.jar (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Server environment:java.io.tmpdir=/tmp (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,669] INFO Notification: 1 (message format version), 2 (n.leader), 0x900000018 (n.zxid), 0x1 (n.round), FOLLOWING (n.state), 3 (n.sid), 0xa (n.peerEpoch) FOLLOWING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
[2019-03-18 15:51:21,669] INFO Server environment:java.compiler=<NA> (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,670] INFO Server environment:os.name=Linux (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,670] INFO Server environment:os.arch=amd64 (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,670] INFO Server environment:os.version=3.10.0-693.5.2.el7.x86_64 (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,670] INFO Server environment:user.name=root (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,670] INFO Server environment:user.home=/root (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,670] INFO Server environment:user.dir=/data/bdata (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,671] INFO Created server with tickTime 2000 minSessionTimeout 4000 maxSessionTimeout 40000 datadir /data/bdata/data/zookeeper/version-2 snapdir /data/bdata/data/zookeeper/version-2 (org.apache.zookeeper.server.ZooKeeperServer)
[2019-03-18 15:51:21,672] INFO FOLLOWING - LEADER ELECTION TOOK - 1931 (org.apache.zookeeper.server.quorum.Learner)
[2019-03-18 15:51:21,673] INFO Resolved hostname: bdata2 to address: bdata2/192.168.33.201 (org.apache.zookeeper.server.quorum.QuorumPeer)
[2019-03-18 15:51:21,676] INFO Getting a snapshot from leader 0xa00000ab4 (org.apache.zookeeper.server.quorum.Learner)
[2019-03-18 15:51:21,879] INFO Accepted socket connection from /192.168.33.200:53308 (org.apache.zookeeper.server.NIOServerCnxnFactory)
[2019-03-18 15:51:21,884] WARN Exception causing close of session 0x0: ZooKeeperServer not running (org.apache.zookeeper.server.NIOServerCnxn)
[2019-03-18 15:51:21,885] INFO Closed socket connection for client /192.168.33.200:53308 (no session established for client) (org.apache.zookeeper.server.NIOServerCnxn)
[2019-03-18 15:51:21,996] INFO Snapshotting: 0xa00000ab4 to /data/bdata/data/zookeeper/version-2/snapshot.a00000ab4 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
[2019-03-18 15:51:22,533] WARN Got zxid 0xa00000ab5 expected 0x1 (org.apache.zookeeper.server.quorum.Learner)
[2019-03-18 15:51:22,533] INFO Creating new log file: log.a00000ab5 (org.apache.zookeeper.server.persistence.FileTxnLog)
