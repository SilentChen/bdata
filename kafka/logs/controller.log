[2019-03-17 12:02:52,896] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-03-17 12:02:52,900] DEBUG [Controller id=1] Preferred replicas by broker Map(2 -> Map(test4-1 -> Vector(2, 3, 1), test1-0 -> Vector(2), test2-2 -> Vector(2)), 1 -> Map(test2-1 -> Vector(1), test4-0 -> Vector(1, 2, 3)), 3 -> Map(test3-0 -> Vector(3, 2, 1), test4-2 -> Vector(3, 1, 2), test2-0 -> Vector(3))) (kafka.controller.KafkaController)
[2019-03-17 12:02:52,901] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2019-03-17 12:02:52,901] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2019-03-17 12:02:52,901] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 Map(test4-0 -> Vector(1, 2, 3)) (kafka.controller.KafkaController)
[2019-03-17 12:02:52,901] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.5 (kafka.controller.KafkaController)
[2019-03-17 12:02:52,901] INFO [Controller id=1] Starting preferred replica leader election for partitions test4-0 (kafka.controller.KafkaController)
[2019-03-17 12:02:52,920] WARN [Controller id=1] Partition test4-0 failed to complete preferred replica leader election to 1. Leader is still 2 (kafka.controller.KafkaController)
[2019-03-17 12:02:52,921] DEBUG [Controller id=1] Topics not in preferred replica for broker 3 Map(test3-0 -> Vector(3, 2, 1), test4-2 -> Vector(3, 1, 2), test2-0 -> Vector(3)) (kafka.controller.KafkaController)
[2019-03-17 12:02:52,921] TRACE [Controller id=1] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2019-03-17 12:02:52,921] INFO [Controller id=1] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2019-03-17 12:06:49,405] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2019-03-17 12:06:49,405] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2019-03-17 12:06:49,409] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2019-03-17 12:06:49,422] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2019-03-17 12:06:49,464] INFO [RequestSendThread controllerId=1] Controller 1 connected to bdata2:9092 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-03-17 12:06:49,658] DEBUG [Controller id=1] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2019-03-17 12:07:00,325] DEBUG [Controller id=1] Sending MetadataRequest to Brokers: Vector(1, 2) for TopicPartitions: ArrayBuffer(test4-2, test4-0, test4-1, test3-0) (kafka.controller.KafkaController)
[2019-03-17 12:07:52,923] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-03-17 12:07:52,923] DEBUG [Controller id=1] Preferred replicas by broker Map(2 -> Map(test4-1 -> Vector(2, 3, 1), test1-0 -> Vector(2), test2-2 -> Vector(2)), 1 -> Map(test2-1 -> Vector(1), test4-0 -> Vector(1, 2, 3)), 3 -> Map(test3-0 -> Vector(3, 2, 1), test4-2 -> Vector(3, 1, 2), test2-0 -> Vector(3))) (kafka.controller.KafkaController)
[2019-03-17 12:07:52,923] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2019-03-17 12:07:52,923] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2019-03-17 12:07:52,924] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 Map(test4-0 -> Vector(1, 2, 3)) (kafka.controller.KafkaController)
[2019-03-17 12:07:52,924] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.5 (kafka.controller.KafkaController)
[2019-03-17 12:07:52,924] INFO [Controller id=1] Starting preferred replica leader election for partitions test4-0 (kafka.controller.KafkaController)
[2019-03-17 12:07:52,987] WARN [Channel manager on controller 1]: Not sending request (type=LeaderAndIsRequest, controllerId=1, controllerEpoch=6, partitionStates={test4-0=PartitionState(controllerEpoch=6, leader=1, leaderEpoch=4, isr=2,1, zkVersion=5, replicas=1,2,3, isNew=false)}, liveLeaders=(bdata1:9092 (id: 1 rack: null))) to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-03-17 12:07:52,987] INFO [Controller id=1] Partition test4-0 completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2019-03-17 12:07:52,987] DEBUG [Controller id=1] Topics not in preferred replica for broker 3 Map(test3-0 -> Vector(3, 2, 1), test4-2 -> Vector(3, 1, 2), test2-0 -> Vector(3)) (kafka.controller.KafkaController)
[2019-03-17 12:07:52,987] TRACE [Controller id=1] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2019-03-17 12:07:52,988] INFO [Controller id=1] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2019-03-17 12:12:52,988] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-03-17 12:12:52,989] DEBUG [Controller id=1] Preferred replicas by broker Map(2 -> Map(test4-1 -> Vector(2, 3, 1), test1-0 -> Vector(2), test2-2 -> Vector(2)), 1 -> Map(test2-1 -> Vector(1), test4-0 -> Vector(1, 2, 3)), 3 -> Map(test3-0 -> Vector(3, 2, 1), test4-2 -> Vector(3, 1, 2), test2-0 -> Vector(3))) (kafka.controller.KafkaController)
[2019-03-17 12:12:52,989] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2019-03-17 12:12:52,989] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2019-03-17 12:12:52,989] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2019-03-17 12:12:52,990] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2019-03-17 12:12:52,990] DEBUG [Controller id=1] Topics not in preferred replica for broker 3 Map(test3-0 -> Vector(3, 2, 1), test4-2 -> Vector(3, 1, 2), test2-0 -> Vector(3)) (kafka.controller.KafkaController)
[2019-03-17 12:12:52,990] TRACE [Controller id=1] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2019-03-17 12:12:52,990] INFO [Controller id=1] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
